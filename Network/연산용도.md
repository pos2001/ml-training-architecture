

<img width="750" height="243" alt="image" src="https://github.com/user-attachments/assets/176ad878-f8c4-45ae-a822-628cd1e35837" />

### μΌλ°μ μΈ ν•™μµ (GPT, BERT λ“±)
```
β… AllReduceλ§ ν…μ¤νΈν•΄λ„ OK!

μ΄μ :
β”β”€ λ€λ¶€λ¶„μ λ”¥λ¬λ‹μ€ AllReduceκ°€ ν•µμ‹¬
β”β”€ κ·Έλλ””μ–ΈνΈ λ™κΈ°ν™” = AllReduce
β”β”€ κ°€μ¥ λ§μ΄ μ‚¬μ©λλ” μ—°μ‚°
β””β”€ λ³‘λ©μ΄ μ—¬κΈ°μ„ λ°μƒ
```






### νΉμν• κ²½μ° (MoE λ¨λΈ λ“±)
```
β οΈ AllToAllλ„ ν…μ¤νΈ ν•„μ”!

μ΄μ :
β”β”€ MoE (Mixture of Experts) λ¨λΈ
β”β”€ μ „λ¬Έκ°€(Expert) λΌμ°ν… = AllToAll
β”β”€ λ μ΄ν„΄μ‹μ— λ§¤μ° λ―Όκ°
β””β”€ AllReduceμ™€ λ‹¤λ¥Έ νΉμ„±

```


### Allgather
```
# νλΌλ―Έν„° μμ§‘

# ZeRO μµν‹°λ§μ΄μ € (DeepSpeed, FSDP)
# νλΌλ―Έν„°λ¥Ό μ—¬λ¬ GPUμ— λ¶„μ‚° μ €μ¥
# Forward μ „μ— μμ§‘ ν•„μ”

# Forward μ „
all_gather(model_parameters)  # νλΌλ―Έν„° μμ§‘
output = forward(input)

λΉλ„: λ§¤ λ μ΄μ–΄λ§λ‹¤
μ¤‘μ”λ„: π΅ λ†’μ (ZeRO μ‚¬μ© μ‹)

```



### ReduceScatter
```
# AllReduceμ μ λ°

# ZeRO μµν‹°λ§μ΄μ €μ—μ„ μ‚¬μ©
# κ·Έλλ””μ–ΈνΈ ν•©μ‚° + λ¶„μ‚° μ €μ¥

reduce_scatter(gradients)  # ν•©μ‚° ν›„ λ‚λ  μ €μ¥

λΉλ„: λ§¤ μ¤ν…
μ¤‘μ”λ„: π΅ λ†’μ (ZeRO μ‚¬μ© μ‹)

```




### AllToAll (νΉμ)
```
# MoE (Mixture of Experts) λ¨λΈ

# κ° ν† ν°μ„ μ „λ¬Έκ°€(Expert)μ—κ² λΌμ°ν…
for layer in moe_layers:
    # ν† ν° λ¶„λ°°
    all_to_all(tokens_to_experts)  # β† λ μ΄ν„΄μ‹ λ―Όκ°!

    # μ „λ¬Έκ°€ μ²λ¦¬
    expert_output = experts(tokens)

    # ν† ν° μμ§‘
    all_to_all(tokens_from_experts)

λΉλ„: MoE λ μ΄μ–΄λ§λ‹¤
μ¤‘μ”λ„: πΆ MoE λ¨λΈμ—μ„λ§ μ¤‘μ”

```




### μμ‚¬κ²°μ • ν”λ΅μ°μ°¨νΈ
```
μ‹μ‘
  β†“
μ§λ¬Έ: μ–΄λ–¤ λ¨λΈ ν•™μµ?
  β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                                 β”‚
β”‚  μΌλ° λ¨λΈ                      β”‚  MoE λ¨λΈ
β”‚  (GPT, BERT, ResNet)            β”‚  (Switch, GLaM)
β”‚                                 β”‚
β†“                                 β†“
AllReduceλ§ ν…μ¤νΈ               AllReduce + AllToAll
(10-20λ¶„)                        (40-60λ¶„)
  β†“                                 β†“
μ¶©λ¶„! β…                           μ™„λ£ β…
  β†“
ZeRO/FSDP μ‚¬μ©?
  β†“
  μ β†’ AllGatherλ„ ν…μ¤νΈ (μ„ νƒ)
  β†“
μ™„λ£ β…

```




```

```
