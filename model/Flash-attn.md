
### Flash-attn은 DEEP LEARNING FRAMEWORKS 계층의 최적화 구현체
```
┌─────────────────────────────────────────────────────────────────────┐
│                    APPLICATION CODE                                  │
│                      (train.py)                                      │
│                                                                       │
│  model = Qwen3MoeForCausalLM.from_pretrained(...)                   │
│  # Flash Attention은 내부적으로 자동 사용됨                         │
└─────────────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────────────┐
│              DISTRIBUTED TRAINING LIBRARIES                          │
│                                                                       │
│  model = deepspeed.initialize(model, ...)                           │
└─────────────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────────────┐
│              DEEP LEARNING FRAMEWORKS                                │
│                   (PyTorch)                                          │
│                                                                       │
│  ┌────────────────────────────────────────────────────┐             │
│  │  MODEL ARCHITECTURES                               │             │
│  │  • Qwen3MoeForCausalLM  ← 모델 아키텍처           │             │
│  └────────────────────────────────────────────────────┘             │
│                            ↓                                         │
│  ┌────────────────────────────────────────────────────┐             │
│  │  OPTIMIZED KERNELS (최적화된 커널)                │             │
│  │  • Flash Attention 2.8.3  ← 여기!                 │             │
│  │  • xFormers                                        │             │
│  │  • Triton kernels                                  │             │
│  │  • torch.nn.functional (기본 구현)                │             │
│  └────────────────────────────────────────────────────┘             │
│                            ↓                                         │
│  • CUDA kernels                                                      │
│  • cuBLAS, cuDNN                                                     │
└─────────────────────────────────────────────────────────────────────┘

```




###
```

```





###
```

```





###
```

```





###
```

```





###
```

```





###
```

```





###
```

```





###
```

```




###
```

```
