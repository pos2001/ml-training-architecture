



### NCCL 통신 그룹
```
┌─────────────────────────────────────────────────┐
│            NCCL Communicator                    │
├─────────────────────────────────────────────────┤
│                                                 │
│  World: Rank 0, 1, 2, 3 (모든 GPU)              │
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │  Rank 0 (Node 1, GPU 0)                 │   │
│  │  Rank 1 (Node 1, GPU 1)                 │   │
│  │  Rank 2 (Node 2, GPU 0)                 │   │
│  │  Rank 3 (Node 2, GPU 1)                 │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
│  All-Reduce 시:                                 │
│  - 4개 Rank 모두 참여                           │
│  - NCCL이 최적 경로 자동 선택                   │
│                                                 │
└─────────────────────────────────────────────────┘

```





### All-Reduce 예시 (4 GPU)
```
Step 1: 각 GPU에서 Gradient 계산
┌─────────────────────────────────────────────────┐
│ Node 1                                          │
│ Rank 0: ∇W = -0.1                               │
│ Rank 1: ∇W = -0.2                               │
└─────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────┐
│ Node 2                                          │
│ Rank 2: ∇W = +0.1                               │
│ Rank 3: ∇W = -0.3                               │
└─────────────────────────────────────────────────┘

Step 2: NCCL All-Reduce 실행
┌─────────────────────────────────────────────────┐
│ Node 1                                          │
│ Process 0 → NCCL: allReduce(gpu0_grad)          │
│ Process 1 → NCCL: allReduce(gpu1_grad)          │
└─────────────────────────────────────────────────┘
         ↓ (노드 내 NVLink)
┌─────────────────────────────────────────────────┐
│ GPU 0 ↔ GPU 1: 데이터 교환                      │
└─────────────────────────────────────────────────┘
         ↓ (노드 간 EFA)
┌─────────────────────────────────────────────────┐
│ Node 1 ↔ Node 2: 데이터 교환                    │
└─────────────────────────────────────────────────┘
         ↓ (Ring AllReduce 알고리즘)
┌─────────────────────────────────────────────────┐
│ 평균 계산: (-0.1 - 0.2 + 0.1 - 0.3) / 4         │
│         = -0.125                                │
└─────────────────────────────────────────────────┘

Step 3: 결과 분배
┌─────────────────────────────────────────────────┐
│ Node 1                                          │
│ Rank 0: ∇W = -0.125                             │
│ Rank 1: ∇W = -0.125                             │
└─────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────┐
│ Node 2                                          │
│ Rank 2: ∇W = -0.125                             │
│ Rank 3: ∇W = -0.125                             │
└─────────────────────────────────────────────────┘

```




### 
```

```


