
## 그럼 컨테이너가 노드당 8개 , 즉 프로세스 하나당 컨테이너 하나를 실행시키는 거야?
### 네, 정확합니다! 
### 1 프로세스 = 1 컨테이너 인스턴스 = 1 GPU

### node1
```
┌─────────────────────────────────────────────────────────┐
│  HOST OS (Ubuntu)                                        │
│                                                          │
│  프로세스 1 (PID: 10001) ◄─► Enroot Container #1        │
│  └─ Rank 0, GPU 0                                       │
│                                                          │
│  프로세스 2 (PID: 10002) ◄─► Enroot Container #2        │
│  └─ Rank 1, GPU 1                                       │
│                                                          │
│  프로세스 3 (PID: 10003) ◄─► Enroot Container #3        │
│  └─ Rank 2, GPU 2                                       │
│                                                          │
│  프로세스 4 (PID: 10004) ◄─► Enroot Container #4        │
│  └─ Rank 3, GPU 3                                       │
│                                                          │
│  프로세스 5 (PID: 10005) ◄─► Enroot Container #5        │
│  └─ Rank 4, GPU 4                                       │
│                                                          │
│  프로세스 6 (PID: 10006) ◄─► Enroot Container #6        │
│  └─ Rank 5, GPU 5                                       │
│                                                          │
│  프로세스 7 (PID: 10007) ◄─► Enroot Container #7        │
│  └─ Rank 6, GPU 6                                       │
│                                                          │
│  프로세스 8 (PID: 10008) ◄─► Enroot Container #8        │
│  └─ Rank 7, GPU 7                                       │
│                                                          │
│  총: 8개 프로세스 = 8개 컨테이너 = 8개 GPU              │
└─────────────────────────────────────────────────────────┘

```


### node 2
```
┌─────────────────────────────────────────────────────────┐
│  HOST OS (Ubuntu)                                        │
│                                                          │
│  프로세스 9 (PID: 20001)  ◄─► Enroot Container #9       │
│  └─ Rank 8, GPU 0                                       │
│                                                          │
│  프로세스 10 (PID: 20002) ◄─► Enroot Container #10      │
│  └─ Rank 9, GPU 1                                       │
│                                                          │
│  ... (프로세스 11-15)                                    │
│                                                          │
│  프로세스 16 (PID: 20008) ◄─► Enroot Container #16      │
│  └─ Rank 15, GPU 7                                      │
│                                                          │
│  총: 8개 프로세스 = 8개 컨테이너 = 8개 GPU              │
└─────────────────────────────────────────────────────────┘

```




### sqsh, sqsh는 커테이너나 당이 아니라 컴퓨트 노드 1개당 땡기는게 맞지? 완전히 맞습니다!
```
/fsx/megatron-training.sqsh (공유 스토리지)
                │
                │ 각 노드가 독립적으로 읽기
                │
        ┌───────┴───────┐
        │               │
        ▼               ▼
   Node 1에서        Node 2에서
   1번만 읽기        1번만 읽기
   (5 GB)           (5 GB)
        │               │
        │               │
        ▼               ▼
   8개 컨테이너      8개 컨테이너
   모두 공유         모두 공유

```


```
┌─────────────────────────────────────────────────┐
│  COMPUTE NODE 1                                  │
│                                                  │
│  Enroot가 이미지를 1번만 마운트                  │
│  └─ /fsx/megatron-training.sqsh                 │
│     └─ 마운트 위치: /var/lib/enroot/...         │
│        (읽기 전용, 공유)                         │
│                                                  │
│  ┌────────────────────────────────────────┐    │
│  │ Container #1 (Rank 0)                  │    │
│  │ └─ rootfs → 이미지 참조 (공유) ◄───┐   │    │
│  └────────────────────────────────────────┘   │    │
│                                               │    │
│  ┌────────────────────────────────────────┐   │    │
│  │ Container #2 (Rank 1)                  │   │    │
│  │ └─ rootfs → 이미지 참조 (공유) ◄───────┤   │    │
│  └────────────────────────────────────────┘   │    │
│                                               │    │
│  ... (Container #3-#7)                        │    │
│                                               │    │
│  ┌────────────────────────────────────────┐   │    │
│  │ Container #8 (Rank 7)                  │   │    │
│  │ └─ rootfs → 이미지 참조 (공유) ◄───────┘   │    │
│  └────────────────────────────────────────┘       │
│                                                  │
│  메모리 사용:                                     │
│  └─ 이미지 캐시: ~5 GB (1번만)                   │
│                                                  │
└─────────────────────────────────────────────────┘

```




```

```
